// Prisma Schema for Ayesha Salon

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

// Services offered at the salon
model Service {
  id          String        @id @default(cuid())
  name        String
  description String
  duration    Int // in minutes
  price       Float
  category    String // e.g., "Hair Coloring", "Haircuts", "Treatments"
  imageUrl    String?
  active      Boolean       @default(true)
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt

  appointments Appointment[]

  @@map("services")
}

// Stylists/Beauticians
model Stylist {
  id           String        @id @default(cuid())
  name         String
  title        String // e.g., "Colourist", "Master Stylist"
  bio          String?
  imageUrl     String?
  specialties  String // JSON array of specialties
  active       Boolean       @default(true)
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt

  appointments Appointment[]
  availability StylistAvailability[]

  @@map("stylists")
}

// Stylist availability schedule
model StylistAvailability {
  id          String   @id @default(cuid())
  stylistId   String
  dayOfWeek   Int // 0 = Sunday, 6 = Saturday
  startTime   String // e.g., "09:00"
  endTime     String // e.g., "17:00"

  stylist     Stylist  @relation(fields: [stylistId], references: [id], onDelete: Cascade)

  @@map("stylist_availability")
}

// Customers
model Customer {
  id           String        @id @default(cuid())
  name         String
  email        String        @unique
  phone        String
  notes        String?
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt

  appointments Appointment[]

  @@map("customers")
}

// Appointments/Bookings
model Appointment {
  id              String   @id @default(cuid())
  customerId      String
  serviceId       String
  stylistId       String?
  date            String // YYYY-MM-DD format
  time            String // HH:MM format
  duration        Int // in minutes
  totalPrice      Float
  status          String   @default("pending") // pending, confirmed, completed, cancelled
  notes           String?
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  customer        Customer @relation(fields: [customerId], references: [id], onDelete: Cascade)
  service         Service  @relation(fields: [serviceId], references: [id], onDelete: Cascade)
  stylist         Stylist? @relation(fields: [stylistId], references: [id], onDelete: SetNull)

  @@map("appointments")
}
